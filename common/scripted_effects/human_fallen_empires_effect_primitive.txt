#

# for country
human_fallen_empires_effect_primitive_down = {
	switch = {
		trigger = has_country_flag
		bronze_age = {
			remove_country_flag = bronze_age
			human_fallen_empires_effect_primitive_set_stone_age = yes
		}
		iron_age = {
			remove_country_flag = iron_age
			human_fallen_empires_effect_primitive_set_bronze_age = yes
		}
		late_medieval_age = {
			remove_country_flag = late_medieval_age
			human_fallen_empires_effect_primitive_set_iron_age = yes
		}
		renaissance_age = {
			remove_country_flag = renaissance_age
			human_fallen_empires_effect_primitive_set_late_medieval_age = yes
		}
		steam_age = {
			remove_country_flag = steam_age
			human_fallen_empires_effect_primitive_set_renaissance_age = yes
		}
		industrial_age = {
			remove_country_flag = industrial_age
			human_fallen_empires_effect_primitive_set_steam_age = yes
		}
		machine_age = {
			remove_country_flag = machine_age
			human_fallen_empires_effect_primitive_set_industrial_age = yes
		}
		atomic_age = {
			remove_country_flag = atomic_age
			human_fallen_empires_effect_primitive_set_machine_age = yes
		}
		early_space_age = {
			remove_country_flag = early_space_age
			human_fallen_empires_effect_primitive_set_atomic_age = yes
		}
	}
	human_fallen_empires_effect_primitive_down_civics = yes
}

human_fallen_empires_effect_primitive_up = {
	switch = {
		trigger = has_country_flag
		stone_age = {
			remove_country_flag = stone_age
			human_fallen_empires_effect_primitive_set_bronze_age = yes
		}
		bronze_age = {
			remove_country_flag = bronze_age
			human_fallen_empires_effect_primitive_set_late_medieval_age = yes
		}
		iron_age = {
			remove_country_flag = iron_age
			human_fallen_empires_effect_primitive_set_iron_age = yes
		}
		late_medieval_age = {
			remove_country_flag = late_medieval_age
			human_fallen_empires_effect_primitive_set_renaissance_age = yes
		}
		renaissance_age = {
			remove_country_flag = renaissance_age
			human_fallen_empires_effect_primitive_set_steam_age = yes
		}
		steam_age = {
			remove_country_flag = steam_age
			human_fallen_empires_effect_primitive_set_industrial_age = yes
		}
		industrial_age = {
			remove_country_flag = industrial_age
			human_fallen_empires_effect_primitive_set_machine_age = yes
		}
		machine_age = {
			remove_country_flag = machine_age
			human_fallen_empires_effect_primitive_set_atomic_age = yes
		}
		atomic_age = {
			remove_country_flag = atomic_age
			human_fallen_empires_effect_primitive_set_early_space_age = yes
		}
		early_space_age = {
			remove_country_flag = early_space_age
			human_fallen_empires_effect_primitive_set_default = yes
		}
	}
	human_fallen_empires_effect_primitive_up_civics = yes
}

human_fallen_empires_effect_primitive_down_civics = {
	if = {
		limit = {
			human_fallen_empires_effect_primitive_has_civic = no
			is_country_type = primitive
		}
		change_government = {
			authority = random
			civics = {
				civic = human_fallen_empires_civic_primitive_degraded_tech
				civic = human_fallen_empires_civic_primitive_degraded_society
			}
		}
	}
}

human_fallen_empires_effect_primitive_up_civics = {
	if = {
		limit = {
			human_fallen_empires_effect_primitive_has_civic = no
			is_country_type = primitive
		}
		change_government = {
			authority = random
			civics = {
				civic = human_fallen_empires_civic_primitive_new_tech
				civic = human_fallen_empires_civic_primitive_unstable_society
			}
		}
	}
}

human_fallen_empires_effect_primitive_was_fallen_civics = {
	if = {
		limit = {
			human_fallen_empires_effect_primitive_has_civic = no
			is_country_type = primitive
		}
		change_government = {
			authority = random
			civics = {
				civic = human_fallen_empires_civic_primitive_was_fallen
				civic = human_fallen_empires_civic_primitive_unstable_society
			}
		}
	}
}

human_fallen_empires_effect_primitive_was_default_civics = {
	if = {
		limit = {
			human_fallen_empires_effect_primitive_has_civic = no
			is_country_type = primitive
		}
		change_government = {
			authority = random
			civics = {
				civic = human_fallen_empires_civic_primitive_was_default
				civic = human_fallen_empires_civic_primitive_unstable_society
			}
		}
	}
}

human_fallen_empires_effect_primitive_set_stone_age = {
	set_graphical_culture = preindustrial_01
	set_country_flag = stone_age
	set_primitive_age = stone_age
	change_country_flag = {
		icon = {
			category = special
			file = primitive.dds
		}
		background = {
			category = backgrounds
			file = new_dawn.dds
		}
		colors = {
			turquoise
			green
			null
			null
		}
	}
}

human_fallen_empires_effect_primitive_set_bronze_age = {
	set_graphical_culture = preindustrial_01
	set_country_flag = bronze_age
	set_primitive_age = bronze_age
	change_country_flag = {
		icon = {
			category = special
			file = primitive.dds
		}
		background = {
			category = backgrounds
			file = new_dawn.dds
		}
		colors = {
			green
			dark_green
			null
			null
		}
	}
}

human_fallen_empires_effect_primitive_set_iron_age = {
	set_graphical_culture = preindustrial_01
	set_country_flag = iron_age
	set_primitive_age = iron_age
	change_country_flag = {
		icon = {
			category = special
			file = primitive.dds
		}
		background = {
			category = backgrounds
			file = new_dawn.dds
		}
		colors = {
			purple
			dark_purple
			null
			null
		}
	}
}

human_fallen_empires_effect_primitive_set_late_medieval_age = {
	set_graphical_culture = preindustrial_01
	set_country_flag = late_medieval_age
	set_primitive_age = late_medieval_age
	change_country_flag = {
		icon = {
			category = special
			file = primitive.dds
		}
		background = {
			category = backgrounds
			file = new_dawn.dds
		}
		colors = {
			light_blue
			blue
			null
			null
		}
	}
}

human_fallen_empires_effect_primitive_set_renaissance_age = {
	set_graphical_culture = preindustrial_01
	set_country_flag = renaissance_age
	set_primitive_age = renaissance_age
	change_country_flag = {
		icon = {
			category = special
			file = primitive.dds
		}
		background = {
			category = backgrounds
			file = new_dawn.dds
		}
		colors = {
			pink
			burgundy
			null
			null
		}
	}
}

human_fallen_empires_effect_primitive_set_steam_age = {
	set_graphical_culture = preindustrial_01
	set_country_flag = steam_age
	set_primitive_age = steam_age
	change_country_flag = {
		icon = {
			category = special
			file = primitive.dds
		}
		background = {
			category = backgrounds
			file = new_dawn.dds
		}
		colors = {
			orange
			red
			null
			null
		}
	}
}

human_fallen_empires_effect_primitive_set_industrial_age = {
	set_graphical_culture = preindustrial_01
	set_graphical_culture = industrial_01
	set_country_flag = industrial_age
	set_primitive_age = industrial_age
	change_country_flag = {
		icon = {
			category = special
			file = primitive.dds
		}
		background = {
			category = backgrounds
			file = new_dawn.dds
		}
		colors = {
			beige
			yellow
			null
			null
		}
	}
}

human_fallen_empires_effect_primitive_set_machine_age = {
	set_graphical_culture = industrial_01
	set_country_flag = machine_age
	set_primitive_age = machine_age
	change_country_flag = {
		icon = {
			category = special
			file = primitive.dds
		}
		background = {
			category = backgrounds
			file = new_dawn.dds
		}
		colors = {
			yellow
			orange
			null
			null
		}
	}
}

human_fallen_empires_effect_primitive_set_atomic_age = {
	set_graphical_culture = industrial_01
	set_country_flag = atomic_age
	set_primitive_age = atomic_age
	change_country_flag = {
		icon = {
			category = special
			file = primitive.dds
		}
		background = {
			category = backgrounds
			file = new_dawn.dds
		}
		colors = {
			beige
			brown
			null
			null
		}
	}
}

human_fallen_empires_effect_primitive_set_early_space_age = {
	set_graphical_culture = industrial_01
	set_country_flag = early_space_age
	set_primitive_age = early_space_age
	change_country_flag = {
		icon = {
			category = special
			file = primitive.dds
		}
		background = {
			category = backgrounds
			file = new_dawn.dds
		}
		colors = {
			grey
			dark_grey
			null
			null
		}
	}
}

human_fallen_empires_effect_primitive_set_random_age = {
	random_list = {
		10 = {
			human_fallen_empires_effect_primitive_set_stone_age = yes
		}
		10 = {
			human_fallen_empires_effect_primitive_set_bronze_age = yes
		}
		10 = {
			human_fallen_empires_effect_primitive_set_iron_age = yes
		}
		10 = {
			human_fallen_empires_effect_primitive_set_late_medieval_age = yes
		}
		10 = {
			human_fallen_empires_effect_primitive_set_renaissance_age = yes
		}
		10 = {
			human_fallen_empires_effect_primitive_set_steam_age = yes
		}
		10 = {
			human_fallen_empires_effect_primitive_set_industrial_age = yes
		}
		10 = {
			human_fallen_empires_effect_primitive_set_machine_age = yes
		}
		10 = {
			human_fallen_empires_effect_primitive_set_atomic_age = yes
		}
		10 = {
			human_fallen_empires_effect_primitive_set_early_space_age = yes
		}
	}
}

human_fallen_empires_effect_primitive_set_army = {
	if = {
		limit = {
			has_country_flag = industrial_age
		}
		PREV = {
			while = {
				count = 4
				create_army = {
					name = "Industrial Army"
					owner = owner
					species = owner
					type = industrial_army
				}
			}
		}
	}
	if = {
		limit = {
			has_country_flag = machine_age
		}
		PREV = {
			while = {
				count = 5
				create_army = {
					name = "Industrial Army"
					owner = owner
					species = owner
					type = industrial_army
				}
			}
		}
	}
	if = {
		limit = {
			has_country_flag = atomic_age
		}
		PREV = {
			while = {
				count = 4
				create_army = {
					name = "Post-Atomic Army"
					owner = owner
					species = owner
					type = postatomic_army
				}
			}
		}
	}
	if = {
		limit = {
			has_country_flag = early_space_age
		}
		PREV = {
			while = {
				count = 5
				create_army = {
					name = "Post-Atomic Army"
					owner = owner
					species = owner
					type = postatomic_army
				}
			}
			create_fleet = {
				name = NAME_Space_Station
				effect = {
					set_owner = owner
					create_ship = {
						name = NAME_Space_Station
						design = NAME_Space_Station
					}
					set_location = PREV
				}
			}
		}
	}
	if = {
		limit = {
			has_country_flag = stone_age
		}
		PREV = {
			create_army = {
				name = "Primitive Army"
				owner = owner
				species = owner
				type = primitive_army
			}
		}
	}
	if = {
		limit = {
			has_country_flag = bronze_age
		}
		PREV = {
			create_army = {
				name = "Primitive Army"
				owner = owner
				species = owner
				type = primitive_army
			}
		}
	}
	if = {
		limit = {
			has_country_flag = iron_age
		}
		PREV = {
			while = {
				count = 2
				create_army = {
					name = "Primitive Army"
					owner = owner
					species = owner
					type = primitive_army
				}
			}
		}
	}
	if = {
		limit = {
			has_country_flag = late_medieval_age
		}
		PREV = {
			while = {
				count = 3
				create_army = {
					name = "Primitive Army"
					owner = owner
					species = owner
					type = primitive_army
				}
			}
		}
	}
	if = {
		limit = {
			has_country_flag = renaissance_age
		}
		PREV = {
			while = {
				count = 4
				create_army = {
					name = "Primitive Army"
					owner = owner
					species = owner
					type = primitive_army
				}
			}
		}
	}
	if = {
		limit = {
			has_country_flag = steam_age
		}
		PREV = {
			while = {
				count = 3
				create_army = {
					name = "Industrial Army"
					owner = owner
					species = owner
					type = industrial_army
				}
			}
		}
	}
}

human_fallen_empires_effect_primitive_set_default = {
	set_country_flag = primitives_can_into_space
	set_country_type = default
	change_country_flag = random
	if = {
		limit = {
			is_species_class = MAM
		}
		set_graphical_culture = mammalian_01
	}
	if = {
		limit = {
			is_species_class = REP
		}
		set_graphical_culture = reptilian_01
	}
	if = {
		limit = {
			is_species_class = AVI
		}
		set_graphical_culture = avian_01
	}
	if = {
		limit = {
			is_species_class = ART
		}
		set_graphical_culture = arthropoid_01
	}
	if = {
		limit = {
			is_species_class = MOL
		}
		set_graphical_culture = molluscoid_01
	}
	if = {
		limit = {
			is_species_class = FUN
		}
		set_graphical_culture = fungoid_01
	}
	if = {
		limit = {
			is_species_class = PLANT
		}
		set_graphical_culture = plantoid_01
	}
	change_government = {
		authority = random
		civics = random
	}
	set_name = random
	if = {
		limit = {
			capital_scope = {
				has_observation_outpost = yes
			}
		}
		capital_scope = {
			observation_outpost_owner = {
				country_event = {
					id = primitive.17
				}
			}
		}
	}
	add_minerals = 1000
	add_energy = 500
	add_influence = 300
	capital_scope = {
		every_tile = {
			limit = {
				has_blocker = yes
				NOR = {
					has_blocker = tb_decrepit_dwellings
					has_blocker = tb_failing_infrastructure
				}
			}
			remove_blocker = yes
		}
		while = {
			limit = {
				num_pops < 8
				any_tile = {
					not = { exists = pop }
					has_blocker = no
				}
			}
			random_tile = {
				limit = {
					not = { exists = pop }
					has_blocker = no
				}
				create_pop = {
					species = owner
				}
			}
		}
		random_tile = {
			limit = {
				exists = pop
				OR = {
					has_building = building_primitive_farm
					has_building = building_primitive_factory
					has_building = no
				}
			}
			human_fallen_empires_effect_set_energy_deposit = yes
			set_building = building_capital_2
		}
		while = {
			count = 2
			random_tile = {
				limit = {
					exists = pop
					OR = {
						has_building = building_primitive_farm
						has_building = building_primitive_factory
						has_building = no
					}
				}
				human_fallen_empires_effect_set_mineral_deposit = yes
				set_building = building_mining_network_1
			}
		}
		while = {
			count = 2
			random_tile = {
				limit = {
					exists = pop
					OR = {
						has_building = building_primitive_farm
						has_building = building_primitive_factory
						has_building = no
					}
				}
				human_fallen_empires_effect_set_food_deposit = yes
				set_building = building_hydroponics_farm_1
			}
		}
		while = {
			count = 3
			random_tile = {
				limit = {
					exists = pop
					OR = {
						has_building = building_primitive_farm
						has_building = building_primitive_factory
						has_building = no
					}
				}
				human_fallen_empires_effect_set_energy_deposit = yes
				set_building = building_power_plant_1
			}
		}
		remove_all_armies = yes
		create_army = {
			name = random
			owner = PREV
			species = owner
			type = defense_army
		}
		create_army = {
			name = random
			owner = PREV
			species = owner
			type = defense_army
		}
		create_army = {
			name = random
			owner = PREV
			species = owner
			type = defense_army
		}
		create_army = {
			name = random
			owner = PREV
			species = owner
			type = defense_army
		}
	}
	random_owned_ship = {
		limit = {
			is_ship_size = primitive_space_station
		}
		delete_fleet = fleet
	}
}

# for planet
human_fallen_empires_effect_primitive_set_primitive = {
	every_tile = {
		limit = {
			has_building = yes
		}
		random_list = {
			95 = {
				remove_building = yes
			}
			5 = {
			}
		}
	}
	owner = {
		save_event_target_as = human_fallen_empires_primitive_owner
	}
	create_country = {
		name = random
		species = event_target:human_fallen_empires_primitive_owner
		type = primitive
		effect = {
			human_fallen_empires_effect_primitive_set_random_age = yes
			if = {
				limit = {
					event_target:human_fallen_empires_primitive_owner = {
						human_fallen_empires_trigger_is_fallen = yes
					}
				}
				human_fallen_empires_effect_primitive_was_fallen_civics = yes
			}
			else = {
				human_fallen_empires_effect_primitive_was_default_civics = yes
			}
		}
	}
	set_owner = last_created_country
	# нужны блокеры
	human_fallen_empires_effect_primitive_set_primitive_buildings = yes
	owner = {
		human_fallen_empires_effect_primitive_set_army = yes
		every_owned_fleet = {
			delete_fleet = this
		}
	}
	every_tile = {
		limit = {
			has_building = no
			exists = pop
		}
		kill_pop = yes
	}
	every_country = {
		establish_communications_no_message = last_created_country
	}
}

human_fallen_empires_effect_primitive_set_primitive_buildings = {
	if = {
		limit = {
			owner = {
				human_fallen_empires_effect_primitive_is_industrial = yes
			}
		}
		if = {
			limit = {
				owner = {
					OR = {
						has_country_flag = machine_age
						has_country_flag = atomic_age
						has_country_flag = early_space_age
					}
				}
			}
			random_tile = {
				limit = {
					has_blocker = no
					has_building = no
					exists = pop
				}
				set_building = building_primitive_factory
			}
		}
		if = {
			limit = {
				owner = {
					has_country_flag = early_space_age
				}
			}
			random_tile = {
				limit = {
					has_blocker = no
					has_building = no
					exists = pop
				}
				set_building = building_primitive_factory
			}
		}
		while = {
			count = 2
			random_tile = {
				limit = {
					has_blocker = no
					has_building = no
					exists = pop
				}
				set_building = building_primitive_factory
			}
		}
		while = {
			count = 4
			random_tile = {
				limit = {
					has_blocker = no
					has_building = no
					exists = pop
				}
				set_building = building_primitive_farm
			}
		}
	}
	else = {
		while = {
			count = 2
			random_tile = {
				limit = {
					has_blocker = no
					has_building = no
					exists = pop
				}
				set_building = building_primitive_farm
			}
		}
		if = {
			limit = {
				last_created_country = {
					has_country_flag = stone_age
				}
			}
			every_tile = {
				limit = {
					has_building = building_primitive_farm
				}
				remove_building = yes
			}
		}
		if = {
			limit = {
				last_created_country = {
					OR = {
						has_country_flag = iron_age
						has_country_flag = late_medieval_age
						has_country_flag = renaissance_age
						has_country_flag = steam_age
					}
				}
			}
			random_tile = {
				limit = {
					has_blocker = no
					has_building = no
					exists = pop
				}
				set_building = building_primitive_farm
			}
		}
		if = {
			limit = {
				last_created_country = {
					OR = {
						has_country_flag = steam_age
						has_country_flag = renaissance_age
					}
				}
			}
			random_tile = {
				limit = {
					has_blocker = no
					has_building = no
					exists = pop
				}
				set_building = building_primitive_farm
			}
		}
		if = {
			limit = {
				last_created_country = {
					has_country_flag = steam_age
				}
			}
			random_tile = {
				limit = {
					has_blocker = no
					has_building = no
					exists = pop
				}
				set_building = building_primitive_factory
			}
		}
	}
}
